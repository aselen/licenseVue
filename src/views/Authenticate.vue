<template>
  <v-container>
    <v-layout justify-center>
      <v-img max-height="50" max-width="250" src="../assets/aselsan.png" />
    </v-layout>

    <v-hover v-slot:default="{ hover }" open-delay="200">
      <v-card
        :elevation="hover ? 16 : 2"
        width="400"
        class="mx-auto mt-10 pa-1"
      >
        <v-card-title>
          <h1 class="display-1">Login</h1>
        </v-card-title>
        <v-card-text>
          <v-form>
            <v-btn v-if="loggedIn" @click="logout">
              {{ user.name + ' ' + user.surname }} Değiştir
            </v-btn>
            <v-text-field
              v-else
              v-model="username"
              label="Username"
              prepend-icon="mdi-account-circle"
            />
            <v-text-field
              v-model="password"
              :type="showPassword ? 'text' : 'password'"
              label="Password"
              prepend-icon="mdi-lock"
              :append-icon="showPassword ? 'mdi-eye' : 'mdi-eye-off'"
              @click:append="showPassword = !showPassword"
            />
          </v-form>
        </v-card-text>

        <v-card-actions>
          <v-spacer></v-spacer>
          <v-btn
            class="px-10"
            color="primary"
            :loading="loading"
            rounded
            @click="login"
            >Login</v-btn
          >
        </v-card-actions>
      </v-card>
    </v-hover>

    <v-layout v-show="error" class="my-5" justify-center>
      <p style="color: red">Giriş işlemi başarısız</p>
    </v-layout>

    <v-layout justify-center>
      <svg width="256" height="256" viewBox="0 0 512 512" fill="none">
        <g id="toll-car">
          <g clip-path="url(#clip0)">
            <g id="car">
              <path
                id="Vector"
                d="M475.797 320.515H462.797C456.722 320.515 451.797 325.44 451.797 331.515V339.515C451.797 345.59 456.722 350.515 462.797 350.515H475.797C481.872 350.515 486.797 345.59 486.797 339.515V331.515C486.797 325.44 481.872 320.515 475.797 320.515Z"
                fill="#E4222E"
              />
              <path
                id="Vector_2"
                d="M221.005 320.722H208.005C201.93 320.722 197.005 325.647 197.005 331.722V339.722C197.005 345.797 201.93 350.722 208.005 350.722H221.005C227.08 350.722 232.005 345.797 232.005 339.722V331.722C232.005 325.647 227.08 320.722 221.005 320.722Z"
                fill="#E4222E"
              />
              <path
                id="Vector_3"
                d="M475.797 320.515H466.428C469.345 320.515 472.143 321.673 474.206 323.736C476.269 325.799 477.428 328.597 477.428 331.515V339.515C477.428 342.432 476.269 345.23 474.206 347.293C472.143 349.356 469.345 350.515 466.428 350.515H475.797C478.714 350.515 481.512 349.356 483.575 347.293C485.638 345.23 486.797 342.432 486.797 339.515V331.515C486.797 328.597 485.638 325.799 483.575 323.736C481.512 321.673 478.714 320.515 475.797 320.515ZM221.005 320.515H211.636C214.553 320.515 217.351 321.673 219.414 323.736C221.477 325.799 222.636 328.597 222.636 331.515V339.515C222.636 342.432 221.477 345.23 219.414 347.293C217.351 349.356 214.553 350.515 211.636 350.515H221.005C223.922 350.515 226.72 349.356 228.783 347.293C230.846 345.23 232.005 342.432 232.005 339.515V331.515C232.005 328.597 230.846 325.799 228.783 323.736C226.72 321.673 223.922 320.515 221.005 320.515Z"
                fill="#C0232C"
              />
              <path
                id="Vector_4"
                d="M416.902 450.961H457.234V490.996C457.234 494.578 455.812 498.012 453.279 500.545C450.747 503.077 447.312 504.5 443.731 504.5H430.406C428.633 504.5 426.877 504.151 425.238 503.472C423.6 502.793 422.111 501.799 420.857 500.545C419.604 499.291 418.609 497.802 417.93 496.164C417.252 494.526 416.902 492.77 416.902 490.996V450.961Z"
                fill="#787681"
              />
              <path
                id="Vector_5"
                d="M442.234 450.961V490.996C442.233 494.431 440.922 497.735 438.568 500.236C436.215 502.738 432.996 504.247 429.568 504.458C429.847 504.475 430.123 504.5 430.406 504.5H443.731C447.312 504.5 450.747 503.077 453.279 500.545C455.812 498.012 457.234 494.578 457.234 490.996V450.961H442.234Z"
                fill="#57565C"
              />
              <path
                id="Vector_6"
                d="M226.766 450.961H267.098V490.996C267.098 494.578 265.675 498.012 263.143 500.545C260.61 503.077 257.176 504.5 253.594 504.5H240.269C236.688 504.5 233.253 503.077 230.721 500.545C228.188 498.012 226.766 494.578 226.766 490.996V450.961H226.766Z"
                fill="#787681"
              />
              <path
                id="Vector_7"
                d="M252.098 450.961V490.996C252.096 494.431 250.785 497.735 248.432 500.236C246.078 502.738 242.86 504.247 239.432 504.458C239.71 504.475 239.986 504.5 240.269 504.5H253.594C257.176 504.5 260.61 503.077 263.143 500.545C265.675 498.012 267.098 494.578 267.098 490.996V450.961H252.098Z"
                fill="#57565C"
              />
              <path
                id="Vector_8"
                d="M467.89 377.29V449.6C467.889 454.183 466.068 458.577 462.828 461.818C459.587 465.058 455.193 466.879 450.61 466.88H233.39C228.808 466.879 224.413 465.058 221.173 461.818C217.932 458.577 216.111 454.183 216.11 449.6V377.29C216.116 367.108 219.987 357.308 226.94 349.87C230.462 346.093 233.228 341.677 235.09 336.86L253.95 287.83C255.202 284.568 257.414 281.763 260.294 279.785C263.174 277.806 266.586 276.748 270.08 276.75H413.92C417.414 276.748 420.826 277.806 423.706 279.785C426.586 281.763 428.798 284.568 430.05 287.83L448.91 336.86C449.839 339.264 450.995 341.574 452.36 343.76C452.6 344.14 452.84 344.52 453.1 344.89C454.287 346.652 455.611 348.317 457.06 349.87C464.018 357.305 467.889 367.107 467.89 377.29Z"
                fill="#EB304A"
              />
              <path
                id="Vector_9"
                d="M457.06 349.87C455.611 348.317 454.287 346.652 453.1 344.89C452.84 344.52 452.6 344.14 452.36 343.76C450.994 341.574 449.839 339.264 448.91 336.86L430.05 287.83C428.798 284.568 426.586 281.763 423.706 279.785C420.826 277.806 417.414 276.748 413.92 276.75H383.92C387.414 276.748 390.826 277.806 393.706 279.785C396.586 281.763 398.798 284.568 400.05 287.83L418.91 336.86C419.839 339.264 420.995 341.574 422.36 343.76C422.6 344.14 422.84 344.52 423.1 344.89C424.287 346.652 425.611 348.317 427.06 349.87C434.018 357.305 437.889 367.107 437.89 377.29V449.6C437.889 454.183 436.068 458.577 432.828 461.818C429.587 465.058 425.193 466.879 420.61 466.88H450.61C455.193 466.879 459.587 465.058 462.828 461.818C466.068 458.577 467.889 454.183 467.89 449.6V377.29C467.889 367.107 464.018 357.305 457.06 349.87Z"
                fill="#E4222E"
              />
              <path
                id="Vector_10"
                d="M418.919 466.88H264.505L284.768 444.558C286.643 442.492 288.929 440.842 291.479 439.713C294.029 438.584 296.788 438 299.577 438H384.291C387.117 438 389.911 438.599 392.489 439.758C395.067 440.917 397.371 442.608 399.247 444.722L418.919 466.88Z"
                fill="#787681"
              />
              <path
                id="Vector_11"
                d="M399.247 444.722C397.371 442.608 395.067 440.917 392.489 439.758C389.911 438.599 387.117 438 384.291 438H354.291C357.117 438 359.911 438.599 362.489 439.758C365.067 440.917 367.371 442.608 369.247 444.722L388.919 466.88H418.919L399.247 444.722Z"
                fill="#57565C"
              />
              <path
                id="Vector_12"
                d="M422.068 409.335C430.352 409.335 437.068 402.619 437.068 394.335C437.068 386.051 430.352 379.335 422.068 379.335C413.784 379.335 407.068 386.051 407.068 394.335C407.068 402.619 413.784 409.335 422.068 409.335Z"
                fill="#FDDD5A"
              />
              <path
                id="Vector_13"
                d="M422.068 379.335C420.359 379.338 418.662 379.635 417.053 380.212C419.973 381.245 422.502 383.158 424.29 385.687C426.078 388.216 427.038 391.238 427.038 394.335C427.038 397.432 426.078 400.454 424.29 402.983C422.502 405.512 419.973 407.425 417.053 408.458C419.112 409.189 421.306 409.462 423.481 409.257C425.657 409.052 427.761 408.374 429.647 407.271C431.532 406.167 433.154 404.665 434.399 402.869C435.643 401.073 436.48 399.027 436.851 396.874C437.222 394.721 437.117 392.512 436.545 390.404C435.973 388.295 434.947 386.337 433.539 384.666C432.131 382.995 430.375 381.652 428.394 380.732C426.412 379.811 424.253 379.334 422.068 379.335Z"
                fill="#FED030"
              />
              <path
                id="Vector_14"
                d="M261.932 409.335C270.216 409.335 276.932 402.619 276.932 394.335C276.932 386.051 270.216 379.335 261.932 379.335C253.648 379.335 246.932 386.051 246.932 394.335C246.932 402.619 253.648 409.335 261.932 409.335Z"
                fill="#FDDD5A"
              />
              <path
                id="Vector_15"
                d="M262.105 379.335C260.396 379.338 258.699 379.635 257.09 380.212C260.01 381.245 262.539 383.158 264.327 385.687C266.115 388.216 267.075 391.238 267.075 394.335C267.075 397.432 266.115 400.454 264.327 402.983C262.539 405.512 260.01 407.425 257.09 408.458C259.149 409.189 261.343 409.462 263.518 409.257C265.693 409.052 267.798 408.374 269.683 407.271C271.569 406.167 273.191 404.665 274.436 402.869C275.68 401.073 276.517 399.027 276.888 396.874C277.259 394.721 277.154 392.512 276.582 390.404C276.01 388.295 274.984 386.337 273.576 384.666C272.168 382.995 270.412 381.652 268.43 380.732C266.449 379.811 264.29 379.334 262.105 379.335Z"
                fill="#FED030"
              />
              <path
                id="Vector_16"
                d="M453.1 344.89H230.9C232.596 342.38 234.001 339.686 235.09 336.86L253.95 287.83C255.202 284.568 257.414 281.763 260.294 279.785C263.174 277.806 266.586 276.748 270.08 276.75H413.92C417.414 276.748 420.826 277.806 423.706 279.785C426.586 281.763 428.798 284.568 430.05 287.83L448.91 336.86C449.839 339.264 450.995 341.574 452.36 343.76C452.6 344.14 452.84 344.52 453.1 344.89Z"
                fill="#00080C"
              />
              <path
                id="Vector_17"
                d="M452.36 343.76C450.995 341.574 449.839 339.264 448.91 336.86L430.05 287.83C428.798 284.568 426.586 281.763 423.706 279.785C420.826 277.806 417.414 276.748 413.92 276.75H383.92C387.414 276.748 390.826 277.806 393.706 279.785C396.586 281.763 398.798 284.568 400.05 287.83L418.91 336.86C419.839 339.264 420.995 341.574 422.36 343.76C422.6 344.14 422.84 344.52 423.1 344.89H453.1C452.84 344.52 452.6 344.14 452.36 343.76Z"
                fill="black"
              />
            </g>
            <g id="barrier">
              <path
                id="Vector_18"
                d="M411.261 441.695L348.31 442.015L348.304 442.008L40.0454 443.547C37.393 443.561 34.8438 442.52 32.9583 440.654C31.0728 438.789 30.0053 436.251 29.9903 433.599L29.7654 387.107L361.55 385.456L410.976 385.209C413.628 385.195 416.177 386.236 418.063 388.101C419.948 389.967 421.016 392.505 421.031 395.157L421.216 431.648C421.223 432.961 420.971 434.263 420.474 435.479C419.978 436.696 419.246 437.802 418.322 438.735C417.397 439.668 416.298 440.41 415.086 440.918C413.875 441.426 412.575 441.69 411.261 441.695Z"
                fill="#8B8893"
              />
              <path
                id="Vector_19"
                d="M411.261 441.695L348.31 442.015L348.304 442.008L361.55 385.456L410.975 385.209C413.628 385.195 416.177 386.236 418.063 388.101C419.948 389.967 421.016 392.505 421.031 395.157L421.216 431.648C421.223 432.961 420.971 434.263 420.474 435.479C419.978 436.696 419.246 437.802 418.322 438.735C417.397 439.668 416.298 440.41 415.086 440.918C413.875 441.426 412.575 441.69 411.261 441.695Z"
                fill="#FDDD5A"
              />
              <path
                id="Vector_20"
                d="M229.031 442.606L242.491 386.047L302.102 385.75L289.796 442.304L229.031 442.606Z"
                fill="#FDDD5A"
              />
              <path
                id="Vector_21"
                d="M106.098 443.219L119.353 386.66L178.805 386.364L165.99 442.92L106.098 443.219Z"
                fill="#FDDD5A"
              />
            </g>
            <path
              id="Vector_22"
              d="M37.5 385.5H39.019C46.9755 385.5 54.6061 388.661 60.2322 394.287C65.8583 399.913 69.019 407.544 69.019 415.5V504.5H7.5V415.5C7.5 407.544 10.6607 399.913 16.2868 394.287C21.9129 388.661 29.5435 385.5 37.5 385.5Z"
              fill="#FDDD5A"
            />
            <path
              id="Vector_23"
              d="M39.0191 385.5H37.5001C35.2314 385.501 32.9701 385.76 30.7594 386.27C37.37 387.795 43.2686 391.515 47.4928 396.824C51.7171 402.132 54.0176 408.716 54.0191 415.5V504.5H69.0191V415.5C69.0191 407.544 65.8584 399.913 60.2323 394.287C54.6062 388.661 46.9756 385.5 39.0191 385.5Z"
              fill="#FED030"
            />
            <path
              id="Vector_24"
              d="M504.5 512H7.50006C5.51094 512 3.60328 511.21 2.19676 509.803C0.790237 508.397 6.10352e-05 506.489 6.10352e-05 504.5C6.10352e-05 502.511 0.790237 500.603 2.19676 499.197C3.60328 497.79 5.51094 497 7.50006 497H504.5C506.489 497 508.397 497.79 509.803 499.197C511.21 500.603 512 502.511 512 504.5C512 506.489 511.21 508.397 509.803 509.803C508.397 511.21 506.489 512 504.5 512Z"
              fill="#787681"
            />
          </g>
        </g>
        <defs>
          <clipPath id="clip0">
            <rect width="512" height="512" fill="white" />
          </clipPath>
        </defs>
      </svg>
    </v-layout>

    <v-footer absolute color="white">
      <v-spacer></v-spacer>
      <div>ASELSAN A.Ş &copy; {{ new Date().getFullYear() }}</div>
    </v-footer>
  </v-container>
</template>

<script>
import { mapState, mapGetters } from 'vuex'

export default {
  name: 'LoginPage',
  data() {
    return {
      loading: false,
      error: false,
      showPassword: false,
      username: undefined,
      password: undefined
    }
  },
  methods: {
    login() {
      this.loading = true
      this.$store
        .dispatch('fetchUser', {
          username: this.username,
          password: this.password
        })
        .then(() => {
          this.$router.push('/weather')
        })
        .catch(err => {
          this.loading = false
          this.error = true
          console.log('There was a problem when login')
          console.log(err)
        })
    },
    logout() {
      this.$store.dispatch('logout')
    }
  },
  computed: {
    ...mapState({
      user: state => state.user
    }),
    ...mapGetters(['loggedIn'])
  }
}
</script>

<style>
#barrier {
  animation: barrier 6s infinite;
  transform-origin: bottom left;
  transform-box: fill-box;
}

@keyframes barrier {
  0% {
    transform: rotateZ(0deg);
  }
  50% {
    transform: rotateZ(-45deg);
  }

  100% {
    transform: rotateZ(0deg);
  }
}

#car {
  animation: car 6s linear infinite;
  transform-origin: bottom;
}

@keyframes car {
  0% {
    transform: scaleY(0);
  }

  50% {
    transform: scaleY(1);
  }

  100% {
    transform: scaleY(0);
  }
}
</style>
